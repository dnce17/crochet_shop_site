{% extends "layout.html" %}

{% block main %}
<div class="cart ctnr">
    <h1>Cart</h1>
    {% if not cart_items %}
        <h3 class="none cart__none">No items in cart</h3>
    {% endif %}
    <section class="cart__products">
        {% if cart_items %}
            <div class="cart_info">
                {% for item in cart_items %}
                    <article class="cart__item">
                        <img src="{{ item.directory }}{{ item.path }}" class="cart__item-col cart__item-col--left cart__item-img" alt="{{ item.alt }}">
                        <div class="cart__item-col cart__item-col--mid">
                            <div class="cart__item-name bold">{{ item.name }}</div>
                            <button class="cart__item-delete-btn">Delete</button>
                        </div>
                        <div class="cart__item-col cart__item-col--right">
                            <div class="cart__item-price bold">{{ item.price }}</div>
                            <div class="cart__item-qty">
                                <h3 class="cart__item-qty-title">Qty:</h3>
                                <select name="qty" class="qty">
                                    <!-- PSEUDOCODE -->
                                    <!-- Cycle through total stock of this ONE item -->
                                    {% for stock_count in current_stocks %}
                                        <!-- Match correct stock_count to current item in loop -->
                                        {% if current_stocks.index(stock_count) == cart_items.index(item) %}
                                            <!--Cycle through this stock count -->
                                            {% for i in range(1, (stock_count | int) + 1) %}
                                                <!-- If num cycled matches desired quantity, make that "selected" -->
                                                {% if i == item["stock"] %}
                                                    <option value="{{ i }}" selected>{{ i }}</option>
                                                {% else %}
                                                    <option value="{{ i }}">{{ i }}</option>
                                                {% endif %}
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </article>
                {% endfor %}
            </div>
            <div class="cart__subtotal">
                <div class="cart__subtotal-text">
                    <h3 class="cart__subtotal-title">Subtotal</h3>
                    <h3 class="cart__subtotal-amt">{{ subtotal }}</h3>
                </div>
                <input type="submit" class="checkout-btn bold" value="Proceed to checkout">
            </div>
        {% endif %}
    </section>
</div>
{% endblock %} 

{% block js %}
<script src="/static/cart.js"></script>
{% endblock %}